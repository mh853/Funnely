# Analytics ëœë”©í˜ì´ì§€ í•„í„° ê°œì„  ì„¤ê³„

## ğŸ“‹ í˜„ì¬ ìƒí™© ë¶„ì„

### ë¬¸ì œì 
**ëœë”©í˜ì´ì§€ ë¶„ì„ í…Œì´ë¸”**ì´ ì›”ë³„ í•„í„°ì— **ë¶€ë¶„ì ìœ¼ë¡œë§Œ ì ìš©**ë˜ê³  ìˆìŒ:

1. **Traffic ë°ì´í„°**: ì›”ë³„ í•„í„° ì ìš© âœ…
   - `landing_page_analytics` í…Œì´ë¸”ì—ì„œ `queryStartDate ~ queryEndDate` í•„í„°ë§
   - 12ì›” í•„í„° â†’ 12ì›” íŠ¸ë˜í”½ ë°ì´í„°ë§Œ ì¡°íšŒ

2. **ëœë”©í˜ì´ì§€ ëª©ë¡**: ì›”ë³„ í•„í„° ë¯¸ì ìš© âŒ
   - `landing_pages` í…Œì´ë¸”ì—ì„œ **ì „ì²´ ëœë”©í˜ì´ì§€ ì¡°íšŒ**
   - 12ì›” í•„í„°ì¸ë° 1ì›”, 2ì›”, 3ì›”... ëª¨ë“  ëœë”©í˜ì´ì§€ê°€ í‘œì‹œë¨

### ì‚¬ìš©ì ê²½í—˜ ë¬¸ì œ
```
ì‹œë‚˜ë¦¬ì˜¤: 12ì›” í•„í„° ì„ íƒ
í˜„ì¬ ë™ì‘:
â”œâ”€ íŠ¸ë˜í”½ ë°ì´í„°: 12ì›”ë§Œ í‘œì‹œ âœ…
â”œâ”€ ì „í™˜ ë°ì´í„°: 12ì›”ë§Œ í‘œì‹œ âœ…
â””â”€ ëœë”©í˜ì´ì§€ ëª©ë¡: ëª¨ë“  ì›”ì˜ ëœë”©í˜ì´ì§€ í‘œì‹œ âŒ
   â†’ 1ì›” ìƒì„± ëœë”©í˜ì´ì§€ (íŠ¸ë˜í”½ 0)
   â†’ 2ì›” ìƒì„± ëœë”©í˜ì´ì§€ (íŠ¸ë˜í”½ 0)
   â†’ 12ì›” ìƒì„± ëœë”©í˜ì´ì§€ (íŠ¸ë˜í”½ ìˆìŒ)

ë¬¸ì œ: íŠ¸ë˜í”½ì´ 0ì¸ ëœë”©í˜ì´ì§€ë“¤ì´ ë§ì´ í‘œì‹œë˜ì–´ í˜¼ë€ìŠ¤ëŸ¬ì›€
```

## ğŸ¯ ê°œì„  ëª©í‘œ

### ê¸°ëŒ€ ë™ì‘
```
ì‹œë‚˜ë¦¬ì˜¤: 12ì›” í•„í„° ì„ íƒ
ê°œì„  í›„:
â”œâ”€ íŠ¸ë˜í”½ ë°ì´í„°: 12ì›”ë§Œ í‘œì‹œ âœ…
â”œâ”€ ì „í™˜ ë°ì´í„°: 12ì›”ë§Œ í‘œì‹œ âœ…
â””â”€ ëœë”©í˜ì´ì§€ ëª©ë¡: 12ì›”ì— ìƒì„±ëœ ëœë”©í˜ì´ì§€ë§Œ í‘œì‹œ âœ…
   â†’ 12ì›” ìƒì„± ëœë”©í˜ì´ì§€ë“¤ë§Œ ë³´ì„
   â†’ í•´ë‹¹ ì›”ì˜ ì‹¤ì œ ì„±ê³¼ë¥¼ ì§‘ì¤‘í•´ì„œ ë³¼ ìˆ˜ ìˆìŒ
```

### ì‚¬ìš©ì ê°€ì¹˜
1. **ê´€ë ¨ì„± í–¥ìƒ**: ì„ íƒí•œ ì›”ê³¼ ê´€ë ¨ëœ ëœë”©í˜ì´ì§€ë§Œ í‘œì‹œ
2. **ë…¸ì´ì¦ˆ ì œê±°**: íŠ¸ë˜í”½ 0ì¸ ë‹¤ë¥¸ ì›” ëœë”©í˜ì´ì§€ ì œê±°
3. **ì¼ê´€ì„±**: íŠ¸ë˜í”½/ì „í™˜ í•„í„°ì™€ ë™ì¼í•œ ê¸°ì¤€ ì ìš©
4. **ë¶„ì„ ìš©ì´ì„±**: í•´ë‹¹ ì›”ì˜ ì„±ê³¼ì— ì§‘ì¤‘ ê°€ëŠ¥

## ğŸ” í˜„ì¬ ì½”ë“œ ë¶„ì„

### Line 155-159: ëœë”©í˜ì´ì§€ ì¡°íšŒ ì¿¼ë¦¬
```typescript
// âŒ í˜„ì¬: ì›”ë³„ í•„í„° ë¯¸ì ìš©
const { data: landingPages } = await supabase
  .from('landing_pages')
  .select('id, title, slug, created_at, views_count')
  .eq('company_id', userProfile.company_id)
  .order('created_at', { ascending: false })
```

**ë¬¸ì œì **:
- `created_at` ê¸°ì¤€ ë‚ ì§œ í•„í„° ì—†ìŒ
- íšŒì‚¬ì˜ ëª¨ë“  ëœë”©í˜ì´ì§€ë¥¼ ì¡°íšŒí•¨
- ì„ íƒëœ ì›”ê³¼ ë¬´ê´€í•˜ê²Œ ì „ì²´ ë°ì´í„° í‘œì‹œ

### Line 162-167: íŠ¸ë˜í”½ ë°ì´í„° ì¡°íšŒ
```typescript
// âœ… í˜„ì¬: ì›”ë³„ í•„í„° ì ìš©ë¨
const { data: monthlyAnalytics } = await supabase
  .from('landing_page_analytics')
  .select('...')
  .eq('landing_pages.company_id', userProfile.company_id)
  .gte('date', queryStartDate)
  .lt('date', queryEndDate)
```

**ì •ìƒ ë™ì‘**:
- `queryStartDate`, `queryEndDate`ë¡œ í•„í„°ë§
- ì„ íƒëœ ì›”ì˜ íŠ¸ë˜í”½ë§Œ ì¡°íšŒ

## ğŸ’¡ ì„¤ê³„ ë°©ì•ˆ

### Option 1: created_at ê¸°ì¤€ í•„í„°ë§ (ì¶”ì²œ)
**ê°œë…**: ëœë”©í˜ì´ì§€ ìƒì„±ì¼(`created_at`)ì´ ì„ íƒëœ ì›”ì— ì†í•˜ëŠ” ê²ƒë§Œ ì¡°íšŒ

**ì¥ì **:
- âœ… ì§ê´€ì : "12ì›” í•„í„° â†’ 12ì›”ì— ë§Œë“  ëœë”©í˜ì´ì§€"
- âœ… êµ¬í˜„ ê°„ë‹¨: ê¸°ì¡´ ì¿¼ë¦¬ì— ë‚ ì§œ í•„í„°ë§Œ ì¶”ê°€
- âœ… ì¼ê´€ì„±: ë‹¤ë¥¸ ë°ì´í„°ì™€ ë™ì¼í•œ í•„í„° ê¸°ì¤€

**ë‹¨ì **:
- âš ï¸ ì´ì „ ì›” ìƒì„± + í˜„ì¬ ì›” íŠ¸ë˜í”½ ìˆëŠ” ê²½ìš° ëˆ„ë½
  - ì˜ˆ: 11ì›” ìƒì„± ëœë”©í˜ì´ì§€ê°€ 12ì›”ì— íŠ¸ë˜í”½ ë°œìƒ

**êµ¬í˜„**:
```typescript
// âœ… ê°œì„ ì•ˆ
const { data: landingPages } = await supabase
  .from('landing_pages')
  .select('id, title, slug, created_at, views_count')
  .eq('company_id', userProfile.company_id)
  .gte('created_at', queryStart)  // ì›”ë³„ í•„í„° ì ìš©
  .lt('created_at', queryEnd)
  .order('created_at', { ascending: false })
```

### Option 2: íŠ¸ë˜í”½ ì¡´ì¬ ê¸°ì¤€ í•„í„°ë§ (ëŒ€ì•ˆ)
**ê°œë…**: ì„ íƒëœ ì›”ì— íŠ¸ë˜í”½ì´ ìˆëŠ” ëœë”©í˜ì´ì§€ë§Œ í‘œì‹œ

**ì¥ì **:
- âœ… ì‹¤ìš©ì : ì‹¤ì œ í™œë™ì´ ìˆëŠ” ëœë”©í˜ì´ì§€ë§Œ í‘œì‹œ
- âœ… ë°ì´í„° ì¤‘ì‹¬: ì„±ê³¼ ë¶„ì„ì— ë” ìœ ìš©

**ë‹¨ì **:
- âŒ ë³µì¡ì„±: JOIN ì¿¼ë¦¬ ë˜ëŠ” í´ë¼ì´ì–¸íŠ¸ í•„í„°ë§ í•„ìš”
- âŒ ë¹„ì§ê´€ì : "12ì›” í•„í„°ì¸ë° 11ì›” ìƒì„± í˜ì´ì§€ í¬í•¨"
- âŒ ì„±ëŠ¥: ì¶”ê°€ ì¡°ì¸ ë˜ëŠ” í›„ì²˜ë¦¬ í•„ìš”

**êµ¬í˜„**:
```typescript
// ë³µì¡í•¨: íŠ¸ë˜í”½ ìˆëŠ” landing_page_id ë¨¼ì € ì¡°íšŒ
const landingPageIdsWithTraffic = monthlyAnalytics
  ?.map(a => a.landing_page_id)
  .filter((id, index, self) => self.indexOf(id) === index)

const { data: landingPages } = await supabase
  .from('landing_pages')
  .select('...')
  .eq('company_id', userProfile.company_id)
  .in('id', landingPageIdsWithTraffic || [])
```

### Option 3: í•˜ì´ë¸Œë¦¬ë“œ ì ‘ê·¼ (ìµœê³ ì˜ UX)
**ê°œë…**:
1. ê¸°ë³¸: ì„ íƒëœ ì›”ì— ìƒì„±ëœ ëœë”©í˜ì´ì§€
2. ì¶”ê°€: ì„ íƒëœ ì›”ì— íŠ¸ë˜í”½ì´ ìˆëŠ” ì´ì „ ì›” ëœë”©í˜ì´ì§€

**ì¥ì **:
- âœ… ì™„ì „ì„±: ê´€ë ¨ëœ ëª¨ë“  ëœë”©í˜ì´ì§€ í‘œì‹œ
- âœ… ì •í™•ì„±: íŠ¸ë˜í”½ì´ ìˆëŠ” í˜ì´ì§€ ëˆ„ë½ ì—†ìŒ

**ë‹¨ì **:
- âŒ ë³µì¡ë„: ë‘ ì¡°ê±´ì„ ORë¡œ ê²°í•©í•´ì•¼ í•¨
- âŒ ì¿¼ë¦¬ ë¹„ìš©: ë” ë³µì¡í•œ ì¿¼ë¦¬ ë˜ëŠ” 2ê°œ ì¿¼ë¦¬ í•„ìš”

## ğŸ“Š ì¶”ì²œ ì†”ë£¨ì…˜: Option 1 (created_at í•„í„°ë§)

### ì´ìœ 
1. **ë‹¨ìˆœì„±**: ìµœì†Œí•œì˜ ì½”ë“œ ë³€ê²½
2. **ì¼ê´€ì„±**: íŠ¸ë˜í”½/ì „í™˜ ë°ì´í„°ì™€ ë™ì¼í•œ í•„í„° ë¡œì§
3. **ì§ê´€ì„±**: ì‚¬ìš©ìê°€ ì´í•´í•˜ê¸° ì‰¬ìš´ ë™ì‘
4. **ì„±ëŠ¥**: ì¶”ê°€ ì¡°ì¸ì´ë‚˜ ë³µì¡í•œ ë¡œì§ ë¶ˆí•„ìš”

### ì œí•œì‚¬í•­ ë° í•´ê²°
**ì œí•œ**: ì´ì „ ì›” ìƒì„± + í˜„ì¬ ì›” íŠ¸ë˜í”½ í˜ì´ì§€ ëˆ„ë½
**ì˜í–¥ë„**: ë‚®ìŒ - ëŒ€ë¶€ë¶„ ëœë”©í˜ì´ì§€ëŠ” ìƒì„± ì§í›„ ì‚¬ìš©ë¨
**ëŒ€ì•ˆ**: í•„ìš”ì‹œ "ì „ì²´" í•„í„°ë¡œ ëª¨ë“  ëœë”©í˜ì´ì§€ í™•ì¸ ê°€ëŠ¥

## ğŸ”§ êµ¬í˜„ ê³„íš

### 1ë‹¨ê³„: ì¿¼ë¦¬ ìˆ˜ì •
**íŒŒì¼**: `src/app/dashboard/analytics/page.tsx`
**ìœ„ì¹˜**: Line 155-159

```typescript
// Before
const { data: landingPages } = await supabase
  .from('landing_pages')
  .select('id, title, slug, created_at, views_count')
  .eq('company_id', userProfile.company_id)
  .order('created_at', { ascending: false })

// After
const { data: landingPages } = await supabase
  .from('landing_pages')
  .select('id, title, slug, created_at, views_count')
  .eq('company_id', userProfile.company_id)
  .gte('created_at', queryStart)
  .lt('created_at', queryEnd)
  .order('created_at', { ascending: false })
```

### 2ë‹¨ê³„: íƒ€ì… ì•ˆì •ì„±
- `queryStart`, `queryEnd`ê°€ ì´ë¯¸ ì •ì˜ë˜ì–´ ìˆìŒ (Line 59-60)
- Timestamp íƒ€ì…ì´ë¯€ë¡œ `created_at` ì»¬ëŸ¼ê³¼ í˜¸í™˜ë¨

### 3ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
```yaml
test_case_1:
  month: "2024-12"
  action: "12ì›” í•„í„° ì„ íƒ"
  expected: "12ì›”ì— ìƒì„±ëœ ëœë”©í˜ì´ì§€ë§Œ í‘œì‹œ"

test_case_2:
  month: "2024-11"
  action: "11ì›” í•„í„° ì„ íƒ"
  expected: "11ì›”ì— ìƒì„±ëœ ëœë”©í˜ì´ì§€ë§Œ í‘œì‹œ"

test_case_3:
  scenario: "11ì›” ìƒì„± í˜ì´ì§€ê°€ 12ì›”ì— íŠ¸ë˜í”½ ë°œìƒ"
  month: "2024-12"
  expected: "í•´ë‹¹ í˜ì´ì§€ ë¯¸í‘œì‹œ (ìƒì„±ì¼ ê¸°ì¤€)"
  workaround: "ì „ì²´ í•„í„°ë¡œ í™•ì¸ ê°€ëŠ¥"
```

## ğŸ“ ì˜ˆìƒ ê²°ê³¼

### Before (í˜„ì¬)
```
12ì›” í•„í„° ì„ íƒ ì‹œ:
â”œâ”€ ëœë”©í˜ì´ì§€ ëª©ë¡ (10ê°œ)
â”‚  â”œâ”€ 2024-01 ìƒì„±: í˜ì´ì§€A (íŠ¸ë˜í”½: 0)
â”‚  â”œâ”€ 2024-02 ìƒì„±: í˜ì´ì§€B (íŠ¸ë˜í”½: 0)
â”‚  â”œâ”€ 2024-11 ìƒì„±: í˜ì´ì§€C (íŠ¸ë˜í”½: 0)
â”‚  â”œâ”€ 2024-12 ìƒì„±: í˜ì´ì§€D (íŠ¸ë˜í”½: 25)
â”‚  â””â”€ 2024-12 ìƒì„±: í˜ì´ì§€E (íŠ¸ë˜í”½: 18)
â””â”€ ë¬¸ì œ: íŠ¸ë˜í”½ 0ì¸ í˜ì´ì§€ë“¤ì´ ëŒ€ë¶€ë¶„
```

### After (ê°œì„  í›„)
```
12ì›” í•„í„° ì„ íƒ ì‹œ:
â”œâ”€ ëœë”©í˜ì´ì§€ ëª©ë¡ (2ê°œ)
â”‚  â”œâ”€ 2024-12 ìƒì„±: í˜ì´ì§€D (íŠ¸ë˜í”½: 25) âœ…
â”‚  â””â”€ 2024-12 ìƒì„±: í˜ì´ì§€E (íŠ¸ë˜í”½: 18) âœ…
â””â”€ ì¥ì : í•´ë‹¹ ì›” ì„±ê³¼ì— ì§‘ì¤‘ ê°€ëŠ¥
```

## ğŸ¯ êµ¬í˜„ ìš°ì„ ìˆœìœ„

**Priority**: ğŸŸ¡ Medium
**Effort**: ğŸŸ¢ Low (5ë¶„ ì´ë‚´)
**Impact**: ğŸŸ¢ High (ì‚¬ìš©ì ê²½í—˜ í¬ê²Œ ê°œì„ )
**Risk**: ğŸŸ¢ Low (ë‹¨ìˆœ í•„í„° ì¶”ê°€)

### êµ¬í˜„ ì‹œì 
- **ì¦‰ì‹œ êµ¬í˜„ ê°€ëŠ¥**: ê¸°ì¡´ ë³€ìˆ˜ í™œìš©, ë‹¨ìˆœ ì¿¼ë¦¬ ìˆ˜ì •
- **ì¢…ì†ì„± ì—†ìŒ**: ë‹¤ë¥¸ ê¸°ëŠ¥ì— ì˜í–¥ ì—†ìŒ
- **ë¡¤ë°± ìš©ì´**: í•„í„° ì¡°ê±´ë§Œ ì œê±°í•˜ë©´ ë³µêµ¬

## ğŸ”„ í–¥í›„ ê°œì„  ë°©í–¥

### Phase 2: ê³ ê¸‰ í•„í„°ë§ (ì„ íƒì‚¬í•­)
ë§Œì•½ ì‚¬ìš©ì í”¼ë“œë°±ì—ì„œ "ì´ì „ ì›” ìƒì„± í˜ì´ì§€ ëˆ„ë½" ë¬¸ì œê°€ ì œê¸°ë˜ë©´:

```typescript
// í•˜ì´ë¸Œë¦¬ë“œ ì ‘ê·¼: ìƒì„±ì¼ OR íŠ¸ë˜í”½ ì¡´ì¬
const landingPageIdsWithTraffic = monthlyAnalytics
  ?.map(a => a.landing_page_id)
  .filter((id, index, self) => self.indexOf(id) === index) || []

let lpQuery = supabase
  .from('landing_pages')
  .select('...')
  .eq('company_id', userProfile.company_id)

// ìƒì„±ì¼ ê¸°ì¤€ OR íŠ¸ë˜í”½ ì¡´ì¬
lpQuery = lpQuery.or(
  `created_at.gte.${queryStart},created_at.lt.${queryEnd},id.in.(${landingPageIdsWithTraffic.join(',')})`
)
```

---

## âœ… êµ¬í˜„ ì™„ë£Œ

### ë³€ê²½ ì‚¬í•­
**íŒŒì¼**: `src/app/dashboard/analytics/page.tsx`
**ë¼ì¸**: 159-160

```typescript
// Before
const { data: landingPages } = await supabase
  .from('landing_pages')
  .select('id, title, slug, created_at, views_count')
  .eq('company_id', userProfile.company_id)
  .order('created_at', { ascending: false })

// After
const { data: landingPages } = await supabase
  .from('landing_pages')
  .select('id, title, slug, created_at, views_count')
  .eq('company_id', userProfile.company_id)
  .gte('created_at', queryStart)  // âœ… ì¶”ê°€ë¨
  .lt('created_at', queryEnd)     // âœ… ì¶”ê°€ë¨
  .order('created_at', { ascending: false })
```

### ê²€ì¦
- âœ… TypeScript íƒ€ì… ì²´í¬ í†µê³¼
- âœ… `queryStart`, `queryEnd` ë³€ìˆ˜ ì´ë¯¸ ì¡´ì¬ (Line 59-60)
- âœ… Timestamp íƒ€ì… í˜¸í™˜ì„± í™•ì¸

### ì˜ˆìƒ ê²°ê³¼
```
12ì›” í•„í„° ì„ íƒ ì‹œ:
Before: ëª¨ë“  ì›”ì˜ ëœë”©í˜ì´ì§€ í‘œì‹œ (ì˜ˆ: 10ê°œ)
After: 12ì›”ì— ìƒì„±ëœ ëœë”©í˜ì´ì§€ë§Œ í‘œì‹œ (ì˜ˆ: 2ê°œ)

íš¨ê³¼:
- ê´€ë ¨ì„± ìˆëŠ” ë°ì´í„°ë§Œ í‘œì‹œ
- íŠ¸ë˜í”½ 0ì¸ í˜ì´ì§€ ì œê±°
- ë¶„ì„ íš¨ìœ¨ì„± í–¥ìƒ
```

---

**ì„¤ê³„ì¼**: 2025-12-25
**êµ¬í˜„ì¼**: 2025-12-25
**ì„¤ê³„ì**: Claude Code
**íƒ€ì…**: UX ê°œì„  + ë°ì´í„° í•„í„°ë§
**ìƒíƒœ**: âœ… êµ¬í˜„ ì™„ë£Œ
