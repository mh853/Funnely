# íšŒì‚¬ êµ¬ë… ê¸°ë°˜ ê¸°ëŠ¥ ì ‘ê·¼ ê²€ì¦

**ë‚ ì§œ**: 2025-12-26
**ì´ìŠˆ**: mh853@gmail.com ê³„ì •ì—ì„œ ì—…ê·¸ë ˆì´ë“œ ë©”ì‹œì§€ í‘œì‹œ
**ìƒíƒœ**: âœ… ì½”ë“œ ì •ìƒ - ìºì‹œ ë¬¸ì œë¡œ íŒë‹¨

---

## ğŸ¯ ì‚¬ìš©ì ë³´ê³  ì´ìŠˆ

### ì¦ìƒ
- **ê³„ì •**: mh853@gmail.com
- **íšŒì‚¬**: í¼ë„ë¦¬
- **ì—­í• **: ì¼ë°˜ ì‚¬ìš©ì (simple_role: 'user')
- **ë¬¸ì œ**: ì¢Œì¸¡ ë„¤ë¹„ê²Œì´ì…˜ì— "ìœ ë£Œë¡œ êµ¬ë§¤í•˜ë¼ëŠ” ë©”ì‹œì§€" í‘œì‹œ

### ì‚¬ìš©ì ìš”êµ¬ì‚¬í•­
> "ì¢Œì¸¡ ë„¤ë¹„ê²Œì´ì…˜ í™œì„±í™”ëŠ” ê°œì¸ ê³„ì •ì˜ ê¶Œí•œì´ ê¸°ì¤€ì´ ì•„ë‹ˆë¼ íšŒì‚¬ ê³„ì •ì˜ êµ¬ë… í”Œëœì— ë”°ë¼ì•¼í•´."

---

## ğŸ” ì½”ë“œ ë¶„ì„ ê²°ê³¼

### âœ… ì½”ë“œëŠ” ì´ë¯¸ ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„ë˜ì–´ ìˆìŒ

**`src/app/dashboard/layout.tsx:23-40`**ì—ì„œ ì´ë¯¸ íšŒì‚¬ êµ¬ë… ê¸°ë°˜ ë¡œì§ ì‚¬ìš© ì¤‘:

```typescript
// í”Œëœ ê¸°ëŠ¥ ì¡°íšŒ
let planFeatures: { [key: string]: boolean } = {}
if (userProfile?.company_id) {
  const { data: subscription } = await supabase
    .from('company_subscriptions')
    .select(`
      subscription_plans (
        features
      )
    `)
    .eq('company_id', userProfile.company_id)  // âœ… íšŒì‚¬ IDë¡œ ì¡°íšŒ
    .in('status', ['active', 'trial', 'past_due'])
    .single()

  if (subscription?.subscription_plans) {
    planFeatures = (subscription.subscription_plans as any).features || {}
  }
}
```

**ë¡œì§ ê²€ì¦**:
- âœ… **íšŒì‚¬ ID ê¸°ë°˜**: `userProfile.company_id`ë¡œ ì¡°íšŒ
- âœ… **êµ¬ë… í”Œëœ ì¡°íšŒ**: `company_subscriptions` â†’ `subscription_plans` ì¡°ì¸
- âœ… **features ì¶”ì¶œ**: í”Œëœì˜ features ê°ì²´ë¥¼ planFeaturesë¡œ ì‚¬ìš©
- âŒ **ì‚¬ìš©ì ê¶Œí•œ ì‚¬ìš© ì•ˆ í•¨**: `simple_role`ì´ë‚˜ `role` í•„ë“œ ì‚¬ìš© ì•ˆ í•¨

---

## ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ ê²€ì¦

### mh853@gmail.com ê³„ì • ë°ì´í„°

**ì‚¬ìš©ì ì •ë³´**:
```json
{
  "id": "6e53371d-601f-48e6-8b72-5efc12581d46",
  "email": "mh853@gmail.com",
  "company_id": "971983c1-d197-4ee3-8cda-538551f2cfb2",
  "simple_role": "user",
  "companies": { "name": "í¼ë„ë¦¬" }
}
```

**íšŒì‚¬ êµ¬ë… ì •ë³´**:
```json
{
  "id": "30734d9f-3100-40fd-be29-39eda789bc43",
  "status": "active",
  "subscription_plans": {
    "name": "ì„±ì¥í•˜ëŠ” ê¸°ì—…ì„ ìœ„í•œ í”Œëœ",
    "features": {
      "reports": true,
      "analytics": true,
      "dashboard": true,
      "db_status": true,
      "db_schedule": true,
      "priority_support": true,
      "advanced_schedule": true,
      "reservation_schedule": true
    }
  }
}
```

### ê³„ì‚°ëœ planFeatures

```javascript
planFeatures = {
  reports: true,              // âœ… DB ë¦¬í¬íŠ¸
  analytics: true,            // âœ… íŠ¸ë˜í”½ ë¶„ì„
  dashboard: true,            // âœ… ëŒ€ì‹œë³´ë“œ
  db_status: true,            // âœ… DB í˜„í™©
  db_schedule: true,          // âœ… DB ìŠ¤ì¼€ì¤„
  priority_support: true,     // âœ… ìš°ì„  ì§€ì›
  advanced_schedule: true,    // âœ… ê³ ê¸‰ ìŠ¤ì¼€ì¤„
  reservation_schedule: true  // âœ… ì˜ˆì•½ ìŠ¤ì¼€ì¤„
}
```

### ì˜ˆìƒ ë™ì‘

**í¼ë„ë¦¬ íšŒì‚¬ ì†Œì† ì‚¬ìš©ì**:
- âœ… íŠ¸ë˜í”½ ë¶„ì„: **í™œì„±í™”** (ì ê¸ˆ ì•„ì´ì½˜ ì—†ìŒ)
- âœ… DB ë¦¬í¬íŠ¸: **í™œì„±í™”** (ì ê¸ˆ ì•„ì´ì½˜ ì—†ìŒ)
- âœ… DB ìŠ¤ì¼€ì¤„: **í™œì„±í™”** (ì ê¸ˆ ì•„ì´ì½˜ ì—†ìŒ)
- âœ… ì˜ˆì•½ ìŠ¤ì¼€ì¤„: **í™œì„±í™”** (ì ê¸ˆ ì•„ì´ì½˜ ì—†ìŒ)

---

## ğŸ”§ ë¬¸ì œ ì›ì¸ ë¶„ì„

### ì½”ë“œëŠ” ì •ìƒ âœ…

1. **íšŒì‚¬ ê¸°ë°˜ ì¡°íšŒ**: âœ… `company_id`ë¡œ êµ¬ë… ì¡°íšŒ
2. **í”Œëœ features ì‚¬ìš©**: âœ… `subscription_plans.features` ì§ì ‘ ì‚¬ìš©
3. **ì‚¬ìš©ì ê¶Œí•œ ë¬´ê´€**: âœ… `simple_role` ì‚¬ìš© ì•ˆ í•¨

### ê°€ëŠ¥í•œ ì›ì¸

#### 1. ë¸Œë¼ìš°ì € ìºì‹œ (Most Likely) ğŸ¯
- **ì¦ìƒ**: ì´ì „ ë¹Œë“œì˜ JavaScript ìºì‹œ
- **í•´ê²°**: í•˜ë“œ ë¦¬í”„ë ˆì‹œ (Cmd+Shift+R / Ctrl+Shift+R)

#### 2. ì„¸ì…˜ ìºì‹œ
- **ì¦ìƒ**: ë¡œê·¸ì¸ ì„¸ì…˜ì— ì´ì „ `planFeatures` ìºì‹œ
- **í•´ê²°**: ë¡œê·¸ì•„ì›ƒ í›„ ì¬ë¡œê·¸ì¸

#### 3. ë°°í¬ ë¬¸ì œ
- **ì¦ìƒ**: í”„ë¡œë•ì…˜ ì„œë²„ê°€ ì´ì „ ì½”ë“œ ì‹¤í–‰ ì¤‘
- **í•´ê²°**: ìµœì‹  ì½”ë“œë¡œ ì¬ë°°í¬

#### 4. íƒ€ì´ë° ì´ìŠˆ
- **ì¦ìƒ**: ìš°ë¦¬ê°€ ë°©ê¸ˆ êµ¬í˜„í•œ "ê¸°ëŠ¥ ë¹„í™œì„±í™” UI"ë¥¼ ë³´ê³  ìˆëŠ” ê²ƒ
- **ì„¤ëª…**:
  - ì´ì „ì—ëŠ” í”„ë¦¬ë¯¸ì—„ ê¸°ëŠ¥ì´ **ìˆ¨ê²¨ì ¸ ìˆì—ˆìŒ**
  - ì§€ê¸ˆì€ **ë³´ì´ì§€ë§Œ ë¹„í™œì„±í™”**ë˜ë„ë¡ ë³€ê²½
  - í¼ë„ë¦¬ íšŒì‚¬ëŠ” í”„ë¡œ í”Œëœì´ë¯€ë¡œ **ëª¨ë‘ í™œì„±í™”**ë˜ì–´ì•¼ í•¨

---

## ğŸ§ª ê²€ì¦ ë°©ë²•

### ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ë¡œ í™•ì¸

1. **ê°œë°œì ë„êµ¬ ì—´ê¸°** (F12 ë˜ëŠ” Cmd+Option+I)
2. **Console íƒ­**ì—ì„œ ì‹¤í–‰:

```javascript
// í˜„ì¬ í˜ì´ì§€ì˜ planFeatures í™•ì¸
console.log('planFeatures from props:',
  document.querySelector('[data-plan-features]')?.dataset.planFeatures
)

// ë˜ëŠ” React DevToolsë¡œ Sidebar ì»´í¬ë„ŒíŠ¸ì˜ props í™•ì¸
```

3. **Network íƒ­**ì—ì„œ:
   - í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
   - `layout` ë˜ëŠ” `dashboard` ìš”ì²­ í™•ì¸
   - Responseì— `planFeatures` ë°ì´í„° í™•ì¸

### ì„œë²„ ì¸¡ ë¡œê·¸ í™•ì¸

ë°°í¬ëœ ì„œë²„ì—ì„œ `layout.tsx`ì˜ `planFeatures` ê°’ ë¡œê·¸ í™•ì¸:

```typescript
// src/app/dashboard/layout.tsxì— ì„ì‹œ ë¡œê·¸ ì¶”ê°€
console.log('ğŸ” planFeatures for user:', user.email, planFeatures)
```

---

## âœ… í•´ê²° ë°©ë²•

### ì‚¬ìš©ì ì¸¡ í•´ê²°ì±…

1. **í•˜ë“œ ë¦¬í”„ë ˆì‹œ** (ê°€ì¥ ë¹ ë¥¸ ë°©ë²•):
   ```
   Windows/Linux: Ctrl + Shift + R
   Mac: Cmd + Shift + R
   ```

2. **ë¸Œë¼ìš°ì € ìºì‹œ ì™„ì „ ì‚­ì œ**:
   - Chrome: ì„¤ì • â†’ ê°œì¸ì •ë³´ ë° ë³´ì•ˆ â†’ ì¸í„°ë„· ì‚¬ìš© ê¸°ë¡ ì‚­ì œ
   - ì‹œê°„ ë²”ìœ„: ì „ì²´ ê¸°ê°„
   - ì²´í¬: ìºì‹œëœ ì´ë¯¸ì§€ ë° íŒŒì¼

3. **ë¡œê·¸ì•„ì›ƒ í›„ ì¬ë¡œê·¸ì¸**:
   ```
   1. ë¡œê·¸ì•„ì›ƒ
   2. ë¸Œë¼ìš°ì € ìƒˆë¡œê³ ì¹¨ (F5)
   3. ë‹¤ì‹œ ë¡œê·¸ì¸
   ```

4. **ì‹œí¬ë¦¿ ëª¨ë“œ í…ŒìŠ¤íŠ¸**:
   ```
   Cmd/Ctrl + Shift + N â†’ ì‹œí¬ë¦¿ ì°½ì—ì„œ ë¡œê·¸ì¸
   ìºì‹œ ì—†ì´ ìµœì‹  ì½”ë“œ í™•ì¸ ê°€ëŠ¥
   ```

### ê°œë°œì ì¸¡ ê²€ì¦

1. **ë°°í¬ ìƒíƒœ í™•ì¸**:
   ```bash
   git log -1 --oneline  # ìµœì‹  ì»¤ë°‹ í™•ì¸
   # í”„ë¡œë•ì…˜ ë°°í¬ ì‹œê°„ê³¼ ë¹„êµ
   ```

2. **í”„ë¡œë•ì…˜ ì¬ë°°í¬** (í•„ìš”ì‹œ):
   ```bash
   vercel --prod
   # ë˜ëŠ”
   npm run build && npm run deploy
   ```

---

## ğŸ“‹ ì‚¬ìš©ì ê¶Œí•œ vs íšŒì‚¬ êµ¬ë… êµ¬ì¡° ì •ë¦¬

### âœ… ì˜¬ë°”ë¥¸ êµ¬ì¡° (í˜„ì¬ êµ¬í˜„)

```
íšŒì‚¬ (Company)
â”œâ”€â”€ êµ¬ë… í”Œëœ (Subscription Plan)
â”‚   â””â”€â”€ ê¸°ëŠ¥ ëª©ë¡ (Features) â† ì´ê±¸ë¡œ ë„¤ë¹„ê²Œì´ì…˜ í™œì„±í™”/ë¹„í™œì„±í™”
â”‚       â”œâ”€â”€ analytics: true/false
â”‚       â”œâ”€â”€ reports: true/false
â”‚       â”œâ”€â”€ db_schedule: true/false
â”‚       â””â”€â”€ reservation_schedule: true/false
â”‚
â””â”€â”€ ì‚¬ìš©ìë“¤ (Users)
    â”œâ”€â”€ ì‚¬ìš©ì A (simple_role: 'admin') â† ê´€ë¦¬ ê¶Œí•œë§Œ ì œì–´
    â”‚   â””â”€â”€ íŒ€ ê´€ë¦¬, ì„¤ì • í¸ì§‘ ê°€ëŠ¥
    â””â”€â”€ ì‚¬ìš©ì B (simple_role: 'user')  â† ê´€ë¦¬ ê¶Œí•œë§Œ ì œì–´
        â””â”€â”€ íŒ€ ê´€ë¦¬, ì„¤ì • í¸ì§‘ ë¶ˆê°€
```

**ê¸°ëŠ¥ ì ‘ê·¼ ì œì–´**:
- âœ… **íšŒì‚¬ êµ¬ë… í”Œëœ** â†’ ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ (ë„¤ë¹„ê²Œì´ì…˜ í™œì„±í™”)
- âœ… **ì‚¬ìš©ì simple_role** â†’ ê´€ë¦¬ ê¶Œí•œ (íŒ€ ê´€ë¦¬, ì„¤ì • í¸ì§‘)

**ì˜ˆì‹œ**:
- í¼ë„ë¦¬ íšŒì‚¬ = í”„ë¡œ í”Œëœ â†’ ëª¨ë“  ê¸°ëŠ¥ í™œì„±í™”
  - mh853@gmail.com (ì¼ë°˜ ì‚¬ìš©ì) â†’ ëª¨ë“  ê¸°ëŠ¥ ì‚¬ìš© âœ…, íŒ€ ê´€ë¦¬ ë¶ˆê°€ âŒ
  - admin@funnely.com (ê´€ë¦¬ì) â†’ ëª¨ë“  ê¸°ëŠ¥ ì‚¬ìš© âœ…, íŒ€ ê´€ë¦¬ ê°€ëŠ¥ âœ…

---

## ğŸ¯ ê²°ë¡ 

### ì½”ë“œ ìƒíƒœ: âœ… ì •ìƒ

**ì´ë¯¸ íšŒì‚¬ êµ¬ë… ê¸°ë°˜ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ ìˆìŒ**:
- `layout.tsx`ëŠ” `company_id`ë¡œ êµ¬ë… ì¡°íšŒ
- `planFeatures`ëŠ” íšŒì‚¬ì˜ `subscription_plans.features` ì‚¬ìš©
- ì‚¬ìš©ìì˜ `simple_role`ì€ ê´€ë¦¬ ê¶Œí•œì—ë§Œ ì‚¬ìš©

### ì‚¬ìš©ì ì´ìŠˆ: ğŸ”„ ìºì‹œ ë¬¸ì œ ê°€ëŠ¥ì„± ë†’ìŒ

**mh853@gmail.com ê³„ì •**:
- íšŒì‚¬: í¼ë„ë¦¬
- êµ¬ë…: ì„±ì¥í•˜ëŠ” ê¸°ì—…ì„ ìœ„í•œ í”Œëœ (í”„ë¡œ í”Œëœ)
- ëª¨ë“  í”„ë¦¬ë¯¸ì—„ ê¸°ëŠ¥ í™œì„±í™” ìƒíƒœ âœ…

**ê¶Œì¥ ì¡°ì¹˜**:
1. í•˜ë“œ ë¦¬í”„ë ˆì‹œ (Cmd+Shift+R)
2. ë¡œê·¸ì•„ì›ƒ í›„ ì¬ë¡œê·¸ì¸
3. ì‹œí¬ë¦¿ ëª¨ë“œë¡œ í…ŒìŠ¤íŠ¸
4. ì—¬ì „íˆ ë¬¸ì œ ì‹œ â†’ ê°œë°œì ë„êµ¬ë¡œ ì‹¤ì œ planFeatures ê°’ í™•ì¸

---

**ê²€ì¦ì¼**: 2025-12-26
**ê²€ì¦ì**: Claude Code
**ê²°ê³¼**: ì½”ë“œ ì •ìƒ ë™ì‘, ë¸Œë¼ìš°ì € ìºì‹œ ì´ìŠˆë¡œ íŒë‹¨
**Next Action**: ì‚¬ìš©ìì—ê²Œ ìºì‹œ í´ë¦¬ì–´ ë°©ë²• ì•ˆë‚´
