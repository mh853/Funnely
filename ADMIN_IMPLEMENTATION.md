# í¼ë„ë¦¬ ì–´ë“œë¯¼ ì‹œìŠ¤í…œ êµ¬í˜„ ì¶”ì  ë¬¸ì„œ

í”„ë¡œì íŠ¸ ì§„í–‰ ìƒí™©ì„ ì¶”ì í•˜ê³  ì „ì²´ ë°©í–¥ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•œ ë¬¸ì„œì…ë‹ˆë‹¤.

---

## ğŸ“Œ í”„ë¡œì íŠ¸ ê°œìš”

**ëª©í‘œ**: í¼ë„ë¦¬ ìŠˆí¼ ì–´ë“œë¯¼ ì‹œìŠ¤í…œ êµ¬ì¶• - ëª¨ë“  íšŒì‚¬ì˜ ê°€ì… ì •ë³´, ê²°ì œ í˜„í™©, í™œë™ ë¡œê·¸, ë¬¸ì˜ì‚¬í•­ì„ í†µí•© ê´€ë¦¬

**ì „ì²´ íƒ€ì„ë¼ì¸**: ì•½ 10-12ì£¼ (ëª¨ë“  Phase í¬í•¨)

**í˜„ì¬ Phase**: Phase 1 ì™„ë£Œ âœ… / Phase 2 ì™„ë£Œ âœ… / Phase 3 ì™„ë£Œ âœ… / Phase 4 (ë¬¸ì˜ ê´€ë¦¬) ì¤€ë¹„ ì¤‘

---

## âœ… êµ¬í˜„ ì§„í–‰ ìƒí™©

### **Phase 1: ê¸°ì´ˆ ì¸í”„ë¼ êµ¬ì¶•** (1-2ì£¼)
**ëª©í‘œ**: ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ, ê¶Œí•œ ì‹œìŠ¤í…œ, ë¯¸ë“¤ì›¨ì–´ ë³´í˜¸

#### 1.1 ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
- [x] `20251213000000_add_super_admin_role.sql` - ìŠˆí¼ ì–´ë“œë¯¼ ì—­í•  ì¶”ê°€
- [x] `20251213000001_create_activity_logs.sql` - í™œë™ ë¡œê·¸ í…Œì´ë¸”
- [x] `20251213000002_create_support_tickets.sql` - ë¬¸ì˜ ê´€ë¦¬ í…Œì´ë¸”
- [x] `20251213000003_create_admin_stats_view.sql` - í†µê³„ ë·°
- [x] `20251213000004_add_admin_rls_policies.sql` - RLS ì •ì±…

**ì‘ì—… ë‚´ìš©**:
```
âœ… ì™„ë£Œ: supabase/migrations/ ë””ë ‰í† ë¦¬ì— 5ê°œ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ìƒì„±
- users í…Œì´ë¸”ì— is_super_admin BOOLEAN ì»¬ëŸ¼ ì¶”ê°€ (ì¸ë±ìŠ¤ í¬í•¨)
- company_activity_logs í…Œì´ë¸” ìƒì„± (í™œë™ ì¶”ì , 3ê°œ ì¸ë±ìŠ¤)
- support_tickets, support_ticket_messages, support_ticket_status_history í…Œì´ë¸” ìƒì„±
- admin_company_stats materialized view ìƒì„± (í†µê³„ ì§‘ê³„)
- RLS ì •ì±…ìœ¼ë¡œ ìŠˆí¼ ì–´ë“œë¯¼ë§Œ ì „ì²´ ë°ì´í„° ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
- ì¼ë°˜ ì‚¬ìš©ìëŠ” ìê¸° íšŒì‚¬ ë°ì´í„°ë§Œ ì ‘ê·¼ ê°€ëŠ¥

âš ï¸ ì£¼ì˜: í”„ë¡œë•ì…˜ DBì— ì§ì ‘ ì ìš© í•„ìš” (Supabase Dashboard SQL Editor ì‚¬ìš©)
```

#### 1.2 ë¯¸ë“¤ì›¨ì–´ ë° ê¶Œí•œ ì‹œìŠ¤í…œ
- [x] `src/lib/admin/permissions.ts` - ê¶Œí•œ ê²€ì¦ ìœ í‹¸
- [x] `src/lib/admin/activity-logger.ts` - í™œë™ ë¡œê¹… ìœ í‹¸ (ë³´ë„ˆìŠ¤)
- [x] `src/middleware.ts` ì—…ë°ì´íŠ¸ - `/admin/*` ê²½ë¡œ ë³´í˜¸

**ì‘ì—… ë‚´ìš©**:
```
âœ… ì™„ë£Œ: ê¶Œí•œ ì‹œìŠ¤í…œ ë° ë¯¸ë“¤ì›¨ì–´ êµ¬í˜„
- permissions.ts: isSuperAdmin(), requireSuperAdmin(), getSuperAdminUser() í•¨ìˆ˜
- middleware.ts: /admin ê²½ë¡œ ì ‘ê·¼ ì‹œ is_super_admin ìë™ ê²€ì¦
- ê¶Œí•œ ì—†ìœ¼ë©´ /dashboardë¡œ ìë™ ë¦¬ë‹¤ì´ë ‰íŠ¸
- activity-logger.ts: íšŒì‚¬ í™œë™ ë¡œê¹… ìœ í‹¸ (logActivity, logUserLogin, logLeadCreated ë“±)
```

---

### **Phase 2: ì–´ë“œë¯¼ ëŒ€ì‹œë³´ë“œ** (2-3ì£¼)
**ëª©í‘œ**: ì–´ë“œë¯¼ ì „ìš© ë ˆì´ì•„ì›ƒ ë° í†µê³„ ëŒ€ì‹œë³´ë“œ

#### 2.1 ë ˆì´ì•„ì›ƒ ë° ë„¤ë¹„ê²Œì´ì…˜
- [x] `src/app/admin/layout.tsx` - ì–´ë“œë¯¼ ë ˆì´ì•„ì›ƒ
- [x] `src/app/admin/components/AdminNav.tsx` - ë„¤ë¹„ê²Œì´ì…˜
- [x] `src/app/admin/page.tsx` - ëŒ€ì‹œë³´ë“œ ë©”ì¸

#### 2.2 ëŒ€ì‹œë³´ë“œ í†µê³„
- [x] `/admin/api/stats/route.ts` API ì—”ë“œí¬ì¸íŠ¸
- [x] `StatsCard.tsx`, `RecentCompanies.tsx`, `SystemAlerts.tsx`, `ActivityFeed.tsx` ì»´í¬ë„ŒíŠ¸
- [x] ì‹¤ì‹œê°„ ë°ì´í„° ê°±ì‹  (60ì´ˆë§ˆë‹¤ ìë™ ê°±ì‹ )

**ì‘ì—… ë‚´ìš©**:
```
âœ… ì™„ë£Œ: ì–´ë“œë¯¼ ëŒ€ì‹œë³´ë“œ UI ë° API êµ¬í˜„
- ì–´ë“œë¯¼ ì „ìš© ë ˆì´ì•„ì›ƒ (ì‚¬ì´ë“œë°” + í—¤ë”)
- 5ê°œ ë©”ë‰´ (ëŒ€ì‹œë³´ë“œ, íšŒì‚¬ê´€ë¦¬, ë¬¸ì˜ê´€ë¦¬, ë¶„ì„, ì„¤ì •)
- í†µê³„ API (/admin/api/stats) - materialized view í™œìš©
- 4ê°œ í†µê³„ ì¹´ë“œ (ì´ íšŒì‚¬, í™œì„± íšŒì‚¬, ì´ ì‚¬ìš©ì, ì‹ ê·œ ë¦¬ë“œ)
- ìµœê·¼ ê°€ì… íšŒì‚¬ ëª©ë¡ (5ê°œ)
- ì‹œìŠ¤í…œ ì•Œë¦¼ (ê¸´ê¸‰ ë¬¸ì˜ ë“±)
- ìµœê·¼ í™œë™ í”¼ë“œ (10ê°œ)
- 60ì´ˆë§ˆë‹¤ ìë™ ê°±ì‹ 
```

---

### **Phase 3: íšŒì‚¬ ê´€ë¦¬** (2-3ì£¼)
**ëª©í‘œ**: íšŒì‚¬ ëª©ë¡, ê²€ìƒ‰, ìƒì„¸ ì •ë³´ ê´€ë¦¬

#### 3.1 íšŒì‚¬ ëª©ë¡ ë° ê²€ìƒ‰
- [x] `src/app/admin/companies/page.tsx`
- [x] `/api/admin/companies` API
- [x] í•„í„°, ê²€ìƒ‰, í˜ì´ì§€ë„¤ì´ì…˜

#### 3.2 íšŒì‚¬ ìƒì„¸ ì •ë³´
- [x] `src/app/admin/companies/[id]/page.tsx`
- [x] íƒ­: ê°œìš”, ì‚¬ìš©ì, í™œë™ ë¡œê·¸

#### 3.3 API ì—”ë“œí¬ì¸íŠ¸
- [x] `GET /admin/api/companies` - íšŒì‚¬ ëª©ë¡ + í•„í„°/ê²€ìƒ‰
- [x] `GET /admin/api/companies/[id]` - íšŒì‚¬ ìƒì„¸
- [x] `PATCH /admin/api/companies/[id]` - íšŒì‚¬ ìƒíƒœ ë³€ê²½
- [x] `GET /admin/api/companies/[id]/users` - ì‚¬ìš©ì ëª©ë¡
- [x] `GET /admin/api/companies/[id]/activities` - í™œë™ ë¡œê·¸

**ì‘ì—… ë‚´ìš©**:
```
âœ… ì™„ë£Œ: íšŒì‚¬ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬í˜„
- íƒ€ì… ì •ì˜ (src/types/admin.ts) - CompanyListItem, CompanyDetail, Filters ë“±
- íšŒì‚¬ ëª©ë¡ í˜ì´ì§€ (/admin/companies)
  * ê²€ìƒ‰ ê¸°ëŠ¥ (íšŒì‚¬ëª…, ë‹´ë‹¹ì ì´ë©”ì¼)
  * í•„í„° (í™œì„±ìƒíƒœ, ê°€ì…ì¼)
  * í˜ì´ì§€ë„¤ì´ì…˜ (20ê°œì”©)
  * ì‹¤ì‹œê°„ í†µê³„ í‘œì‹œ
- íšŒì‚¬ ìƒì„¸ í˜ì´ì§€ (/admin/companies/[id])
  * ê°œìš” íƒ­: 4ê°œ í†µê³„ ì¹´ë“œ, ê¸°ë³¸ ì •ë³´, ìµœê·¼ í™œë™
  * ì‚¬ìš©ì íƒ­: ì‚¬ìš©ì ëª©ë¡, ì—­í• /ìƒíƒœ í•„í„°
  * í™œë™ ë¡œê·¸ íƒ­: íƒ€ì„ë¼ì¸ í˜•ì‹, ë‚ ì§œ í•„í„°
  * íšŒì‚¬ í™œì„±í™”/ë¹„í™œì„±í™” ê¸°ëŠ¥
- API ì—”ë“œí¬ì¸íŠ¸ 5ê°œ êµ¬í˜„
- ì„±ëŠ¥ ìµœì í™” ì¸ë±ìŠ¤ ì¶”ê°€ (ë§ˆì´ê·¸ë ˆì´ì…˜)
  * companies í…Œì´ë¸”: created_at, is_active, name_search, slug
  * users í…Œì´ë¸”: company_id, company_active, role, email_search
  * leads í…Œì´ë¸”: company_id, company_created
  * landing_pages í…Œì´ë¸”: company_id, company_published
```

---

### **Phase 4: ë¬¸ì˜ ê´€ë¦¬ ì‹œìŠ¤í…œ** (2-3ì£¼)
**ëª©í‘œ**: ë¬¸ì˜ ëª©ë¡, ìƒì„¸, ì‘ë‹µ ì‹œìŠ¤í…œ

#### 4.1 ë¬¸ì˜ ëª©ë¡ ë° í•„í„°
- [ ] `src/app/admin/support/page.tsx`
- [ ] Kanban ë³´ë“œ / í…Œì´ë¸” ë·°
- [ ] í•„í„° (ìƒíƒœ, ìš°ì„ ìˆœìœ„, ì¹´í…Œê³ ë¦¬)

#### 4.2 ë¬¸ì˜ ìƒì„¸ ë° ì‘ë‹µ
- [ ] `src/app/admin/support/[id]/page.tsx`
- [ ] ë©”ì‹œì§€ ìŠ¤ë ˆë“œ, ì‘ë‹µ í¼, ì‚¬ì´ë“œë°”

#### 4.3 ì¼ë°˜ ì‚¬ìš©ì ë¬¸ì˜ ìƒì„±
- [ ] `src/app/dashboard/support/page.tsx`
- [ ] ë¬¸ì˜ ìƒì„± í¼, ë¬¸ì˜ ëª©ë¡

**ì‘ì—… ë‚´ìš©**:
```
- ëŒ€ê¸° ì¤‘
```

---

### **Phase 5: í™œë™ ë¡œê¹… ë° ë¶„ì„** (1-2ì£¼)
**ëª©í‘œ**: í™œë™ ë¡œê·¸ ìˆ˜ì§‘ ë° ë¶„ì„ ëŒ€ì‹œë³´ë“œ

#### 5.1 í™œë™ ë¡œê·¸ ìˆ˜ì§‘
- [ ] `src/lib/admin/activity-logger.ts`
- [ ] ì£¼ìš” ì´ë²¤íŠ¸ íŠ¸ë˜í‚¹ ì¶”ê°€

#### 5.2 ë¶„ì„ ëŒ€ì‹œë³´ë“œ
- [ ] `src/app/admin/analytics/*`
- [ ] ë§¤ì¶œ, ì‚¬ìš©ëŸ‰, ì„±ì¥ ì§€í‘œ ì°¨íŠ¸

**ì‘ì—… ë‚´ìš©**:
```
- ëŒ€ê¸° ì¤‘
```

---

### **Phase 6: ê²°ì œ ë° êµ¬ë… ê´€ë¦¬** (ì„ íƒì , 3ì£¼)
**ëª©í‘œ**: ê²°ì œ ë‚´ì—­, êµ¬ë… ê´€ë¦¬ (ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™)

- [ ] Stripe/Toss ì›¹í›… ìˆ˜ì‹ 
- [ ] ê²°ì œ ë‚´ì—­ ì¡°íšŒ
- [ ] êµ¬ë… í”Œëœ ë³€ê²½

**ì‘ì—… ë‚´ìš©**:
```
- ëŒ€ê¸° ì¤‘
```

---

## ğŸ“Š ì „ì²´ ì§„í–‰ë¥ 

```
Phase 1: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ… (ì™„ë£Œ)
Phase 2: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ… (ì™„ë£Œ)
Phase 3: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ… (ì™„ë£Œ)
Phase 4: â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%   (ì¤€ë¹„ ì¤‘)
Phase 5: â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%   (ëŒ€ê¸°)
Phase 6: â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%   (ëŒ€ê¸°)

ì „ì²´: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘ 50%
```

---

## ğŸ¯ ë‹¤ìŒ ì‘ì—…

**í˜„ì¬ ì‘ì—…**: Phase 4 - ë¬¸ì˜ ê´€ë¦¬ ì‹œìŠ¤í…œ

**ìˆœì„œ**:
1. âœ… Phase 1 ì™„ë£Œ (DB ë§ˆì´ê·¸ë ˆì´ì…˜, ê¶Œí•œ ì‹œìŠ¤í…œ, ë¯¸ë“¤ì›¨ì–´)
2. âœ… Phase 2 ì™„ë£Œ (ì–´ë“œë¯¼ ë ˆì´ì•„ì›ƒ, ëŒ€ì‹œë³´ë“œ, í†µê³„ API)
3. âœ… Phase 3 ì™„ë£Œ (íšŒì‚¬ ëª©ë¡, ìƒì„¸, API ì—”ë“œí¬ì¸íŠ¸)
4. ğŸ”œ ë¬¸ì˜ ëª©ë¡ í˜ì´ì§€ (/admin/support)
5. ë¬¸ì˜ ìƒì„¸ í˜ì´ì§€ (/admin/support/[id])
6. ì¼ë°˜ ì‚¬ìš©ì ë¬¸ì˜ ìƒì„± (/dashboard/support)

---

## ğŸ“ ì¤‘ìš” ê²°ì •ì‚¬í•­

### ì•„í‚¤í…ì²˜ ê²°ì •
- âœ… ê¸°ì¡´ ì‹œìŠ¤í…œ í™•ì¥ ë°©ì‹ ì±„íƒ (`/admin/*` ê²½ë¡œ ì¶”ê°€)
- âœ… Supabase RLSë¡œ ë°ì´í„° ì ‘ê·¼ ì œì–´
- âœ… Materialized Viewë¡œ í†µê³„ ì„±ëŠ¥ ìµœì í™”

### ê¸°ìˆ  ìŠ¤íƒ
- âœ… Next.js 14 (App Router)
- âœ… Supabase (PostgreSQL + RLS)
- âœ… TypeScript
- ì˜ˆì •: React Query/SWR (ë°ì´í„° ìºì‹±)
- ì˜ˆì •: Recharts (ì°¨íŠ¸)

### ë³´ì•ˆ ì •ì±…
- âœ… `is_super_admin` í”Œë˜ê·¸ë¡œ ê¶Œí•œ ê´€ë¦¬
- âœ… ë¯¸ë“¤ì›¨ì–´ë¡œ `/admin/*` ê²½ë¡œ ë³´í˜¸
- âœ… RLSë¡œ ë°ì´í„°ë² ì´ìŠ¤ ë ˆë²¨ ë³´ì•ˆ

---

## ğŸ› ì´ìŠˆ íŠ¸ë˜í‚¹

### í•´ê²°ëœ ì´ìŠˆ
- ì—†ìŒ (ì•„ì§ êµ¬í˜„ ì‹œì‘ ì•ˆí•¨)

### ì§„í–‰ ì¤‘ ì´ìŠˆ
- ì—†ìŒ

### ì˜ˆìƒ ì´ìŠˆ
- [ ] pg_cron ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸ í•„ìš” (í†µê³„ ë·° ìë™ ê°±ì‹ )
- [ ] ìŠˆí¼ ì–´ë“œë¯¼ ì´ˆê¸° ê³„ì • ìƒì„± ë°©ë²• ê²°ì •

---

## ğŸ“… ë§ˆì¼ìŠ¤í†¤

- [ ] **Week 2**: Phase 1 ì™„ë£Œ (ì¸í”„ë¼ êµ¬ì¶•)
- [ ] **Week 5**: Phase 2 ì™„ë£Œ (ëŒ€ì‹œë³´ë“œ)
- [ ] **Week 8**: Phase 3 ì™„ë£Œ (íšŒì‚¬ ê´€ë¦¬)
- [ ] **Week 11**: Phase 4 ì™„ë£Œ (ë¬¸ì˜ ê´€ë¦¬) - **MVP ì™„ì„±**
- [ ] **Week 13**: Phase 5 ì™„ë£Œ (ë¶„ì„)
- [ ] **Week 16**: Phase 6 ì™„ë£Œ (ê²°ì œ ê´€ë¦¬) - **ì „ì²´ ì™„ì„±**

---

## ğŸ“– ì°¸ê³  ë¬¸ì„œ

- [ì „ì²´ ì„¤ê³„ ë¬¸ì„œ](./docs/admin-system-design.md) (ë³„ë„ ìƒì„± ì˜ˆì •)
- [API ëª…ì„¸ì„œ](./docs/admin-api-spec.md) (ë³„ë„ ìƒì„± ì˜ˆì •)
